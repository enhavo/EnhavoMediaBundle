{% block enhavo_files_widget %}
    {% spaceless %}
        {% trans_default_domain 'EnhavoAppBundle' %}
            <div class="uploadForm" data-multiple="{% if multiple %}1{% else %}0{% endif %}">

                <script type="text/html" data-id="files-template">
                    {% if multiple %}
                        <li class="imgContainer" data-file-element data-id="{file_id}">
                            <div class="imgdelete">
                                <i class="fa fa-times fa-2x"></i>
                            </div>
                            <div class="uploadForm-image-container">
                                <img src="/file/{file_id}/100/100">
                                <div class="uploadForm-image-overlay"><i class="icon-edit-1"></i> <i class="icon-swap"></i></div>
                            </div>
                            <input type="hidden" name="{full_name}[{file_index}][id]" value="{file_id}" />
                            <input type="hidden" name="{full_name}[{file_index}][order]" data-file-element-order value="" />
                            <input type="hidden" name="{full_name}[{file_index}][filename]" value="{file_name}" data-field-name="filename" />
                            <input type="hidden" name="{full_name}[{file_index}][slug]" value="{file_slug}" data-field-name="slug" />
                            {% for field_name, field_options in fields %}
                                <input type="hidden"
                                       name="{full_name}[{file_index}][parameters][{{ field_name }}]"
                                       value=""
                                       data-field-name="pa_{{ field_name }}" />
                            {% endfor %}
                        </li>
                    {% else %}
                        <div class="imgContainer singleImage" data-file-element data-id="{file_id}">
                            <div class="imgdelete">
                                <i class="fa fa-times fa-2x"></i>
                            </div>
                            <div class="uploadForm-image-container">
                                <img src="/file/{file_id}/100/100">
                                <div class="uploadForm-image-overlay"><i class="icon-edit-1"></i></div>
                            </div>
                            <input type="hidden" name="{full_name}[id]" value="{file_id}" />
                            <input type="hidden" name="{full_name}[order]" data-file-element-order value="" />
                            <input type="hidden" name="{full_name}[filename]" value="{file_name}" data-field-name="filename" />
                            <input type="hidden" name="{full_name}[slug]" value="{file_slug}" data-field-name="slug" />
                            {% for field_name, field_options in fields %}
                                <input type="hidden"
                                       name="{full_name}[parameters][{{ field_name }}]"
                                       value=""
                                       data-field-name="pa_{{ field_name }}" />
                            {% endfor %}
                        </div>
                    {% endif %}
                </script>

                <div class="layer posrel">
                    {% if form.information %}
                        <div class="hintBox mb1">
                            <ul class="bullList">
                                {% for info in form.information %}
                                   <li>{{ info|trans }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                    {% endif %}

                    <div class="imagePreview posrel{% if multiple %} multiple{% endif %}">
                        <div class="progress">
                            <div class="bar" style="width: 0%;"></div>
                        </div>

                        {% if multiple %}
                            <div class="dropzone fade well{% if form.vars.value|length < 1 %} empty{% endif %}">
                                <ul class="list clearfix" data-name="{{ full_name }}" data-file-list>
                                    {% for index, file in form.vars.value %}
                                        {% if file %}
                                            <li class="imgContainer" data-file-element data-id="{{ file.id }}">
                                                <div class="imgdelete">
                                                    <i class="fa fa-times fa-2x"></i>
                                                </div>
                                                <div class="uploadForm-image-container">
                                                    <img src="/file/{{ file.id }}/100/100">
                                                    <div class="uploadForm-image-overlay"><i class="icon-edit-1"></i> <i class="icon-swap"></i></div>
                                                </div>
                                                <input type="hidden" name="{{ full_name }}[{{ index }}][id]" value="{{ file.id }}" />
                                                <input type="hidden" name="{{ full_name }}[{{ index }}][order]" data-file-element-order value="{{ file.order }}" />
                                                <input type="hidden" name="{{ full_name }}[{{ index }}][filename]" value="{{ file.filename }}" data-field-name="filename" />
                                                <input type="hidden" name="{{ full_name }}[{{ index }}][slug]" value="{{ file.slug }}" data-field-name="slug" />
                                                {% for field_name, field_options in fields %}
                                                    <input type="hidden"
                                                        name="{{ full_name }}[{{ index }}][parameters][{{ field_name }}]"
                                                        value="{% if file.parameters[field_name] is defined %}{{ file.parameters[field_name] }}{% endif %}"
                                                        data-field-name="pa_{{ field_name }}" />
                                                {% endfor %}
                                          </li>
                                       {% endif %}
                                    {% endfor %}
                                </ul>
                            </div>
                            <input id="{{ id }}" class="fileupload hidden" type="file" data-url="{{ path('enhavo_media_upload') }}" multiple>
                        {% else %}
                            <div class="dropzone fade well{% if form.vars.value|length < 1 %} empty{% endif %}">
                                <div class="list clearfix" data-name="{{ full_name }}" data-file-list>
                                    {% if form.vars.value|length > 0 %}
                                        {% if form.vars.value[0] %}
                                            <div class="imgContainer singleImage" data-file-element data-id="{{ form.vars.value[0].id }}">
                                                <div class="imgdelete">
                                                    <i class="fa fa-times fa-2x"></i>
                                                </div>
                                                <div class="uploadForm-image-container">
                                                    <img src="/file/{{ form.vars.value.id }}/100/100">
                                                    <div class="uploadForm-image-overlay"><i class="icon-edit-1"></i></div>
                                                </div>
                                                <input type="hidden" name="{{ full_name }}[id]" value="{{ form.vars.value.id }}" />
                                                <input type="hidden" name="{{ full_name }}[order]" data-file-element-order value="{{ form.vars.value.order }}" />
                                                <input type="hidden" name="{{ full_name }}[filename]" value="{{ form.vars.value.filename }}" data-field-name="filename" />
                                                <input type="hidden" name="{{ full_name }}[slug]" value="{{ form.vars.value.slug }}" data-field-name="slug" />
                                                {% for field_name, field_options in fields %}
                                                    <input type="hidden"
                                                           name="{{ full_name }}[parameters][{{ field_name }}]"
                                                           value="{% if form.vars.value.parameters[field_name] is defined %}{{ form.vars.value.parameters[field_name] }}{% endif %}"
                                                           data-field-name="pa_{{ field_name }}" />
                                                {% endfor %}
                                            </div>
                                        {% endif %}
                                    {% endif %}
                                </div>
                            </div>
                            <input id="{{ id }}" class="fileupload hidden" type="file" data-url="{{ path('enhavo_media_upload') }}">
                        {% endif %}
                    </div>
                    <div class="fileupload-fields disabled hidden" data-selected="">
                        <div class="fileupload-field row">
                            <div class="col-md-4 fileupload-field-label-container">
                                <label for="fileupload-field-filename" class="fileupload-field-label">{{ 'media.form.label.filename'|trans({}, 'EnhavoMediaBundle') }}</label>
                            </div>
                            <div class="col-md-8 fileupload-field-input-container">
                                <div class="input-container">
                                    <input id="fileupload-field-filename" class="fileupload-field-input" type="text" name="" data-field-name="filename" disabled />
                                </div>
                            </div>
                        </div>
                        <div class="fileupload-field row">
                            <div class="col-md-4 fileupload-field-label-container">
                                <label for="fileupload-field-slug" class="fileupload-field-label">{{ 'media.form.label.slug'|trans({}, 'EnhavoMediaBundle') }}</label>
                            </div>
                            <div class="col-md-8 fileupload-field-input-container">
                                <span id="fileupload-field-slug" class="fileupload-field-slug" data-field-name="slug"> </span>
                            </div>
                        </div>
                        {% for field_name, field_options in fields %}
                            <div class="fileupload-field row">
                                <div class="col-md-4 fileupload-field-label-container">
                                    <label for="fileupload-field-{{ field_name }}" class="fileupload-field-label">{{ field_options['label']|trans({}, field_options['translationDomain']) }}</label>
                                </div>
                                <div class="col-md-8 fileupload-field-input-container">
                                    <div class="input-container">
                                        <input id="fileupload-field-{{ field_name }}" class="fileupload-field-input" type="text" name="" data-field-name="pa_{{ field_name }}" disabled />
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                    <div class="mt1">
                        <button class="btn upload-button"> {{ 'label.upload'|trans }}</button>
                    </div>
                </div>
            </div>
    {% endspaceless %}
{% endblock %}